<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>IA-code Classificador de Linguagem de Programação</title>
    
    
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h2>IA-code</h2>
                <p>O modelo pode apresentar falhas nas previsões</p>
            </div>
        </div>
          
        <div class="row">
            <div class="col-md-12">
                <div class="result" id="result"></div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="input-section">
                    <textarea id="code" class="form-control" rows="5" placeholder="Cole seu código aqui..."></textarea>
                    <button class="btn btn-primary" onclick="PrevisaoLinguagem()">Verificar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function PrevisaoLinguagem() {
            const code = document.getElementById("code").value.trim();
            const resultDiv = document.getElementById("result");
          resultDiv.innerHTML = `
         <div class="typing">
          <span>Digitando</span>
           <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
         </div>
        `;


            if (!code) {
                resultDiv.textContent = "Por favor, insira algum código.";
                return;
            }

            try {
                const response = await fetch("/predict", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ code })
                });

                if (!response.ok) {
                    const text = await response.text();
                    console.error("Erro do servidor:", text);
                    resultDiv.textContent = "Erro ao conectar com o servidor.";
                    return;
                }

                const data = await response.json();
                if (data.best_prediction) {
                    resultDiv.textContent = "Linguagem prevista: " + data.best_prediction;
                } else if (data.error) {
                    resultDiv.textContent = "Erro: " + data.error;
                } else {
                    resultDiv.textContent = "Erro ao tentar prever a linguagem.";
                }
            } catch (err) {
                console.error("Erro:", err);
                resultDiv.textContent = "Erro na comunicação com o servidor.";
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>
